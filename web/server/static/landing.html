<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf8"/>
		<title>We Snap</title>
		<meta name="description" content=""/>
		<meta name="author" content="Stupeflix"/>
		
		<!-- HTML 5 fix for IE6-8-->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		
		<!-- Stylesheets -->
		<link href="http://fonts.googleapis.com/css?family=Allerta" rel="stylesheet"/>
		<link href="./css/bootstrap.min.css" rel="stylesheet"/>
		<link href="./css/landing.css" rel="stylesheet"/>
		
		<!-- jQuery -->
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
	</head>
	
	<body>
		
		<img id="background" src="./img/background.jpg"/>
		
		<div id="container">
			<div id="container-background"></div>
			
			<header>We Snap</header>
			
			<p id="description">
				Create an event and share its code with your friends to let them add photos to your slideshow <strong>LIVE</strong> from their iPhones!
			</p>
			
			<div id="createevent">
				<button class="btn primary">Create an event</button>
			</div>
		
			<div id="newevent" style="display:none">
				Your Event Number: <span id="eventcode"></span>
				<p>
					Share this code with your friends!<br/>
					View your slideshow at <span id="eventurl"></span>
				</p>
			</div>
			
			<div id="getapp">
				<p>
					Want to join an event?<br/>
					Get <strong>We Snap</strong> for iPhone!
				</p>
				<a href="#" title="Get We Snap on the App Store">
					<img src="./img/appstore.png" alt="iPhone App Store"/>
				</a>
			</div>
		</div>
		
		<script>
			function onUserLocated(position) {
				remoteService = 'new/' + position.coords.latitude + '-' + position.coords.longitude;
				$.get(remoteService, fadeCreateEventButton);
			}

			function onLocationError(errorMsg) {
				console.error('Geolocation error: ' + errorMsg);
			}

			function fadeCreateEventButton(code) {
				$('#createevent').fadeOut(250, function() {
					pageUrl = window.location.toString();
					url = pageUrl+code;
					$('#eventcode').text(code);
					$('#eventurl').html('<a href="'+url+'">'+url+'</a>');
					$('#newevent').fadeIn(250);
				});
			}

			$('#createevent button').click(function() {
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(onUserLocated, onLocationError);
				} else {
					console.error('Geolocation unavailable on this browser!');
				}
			});
		</script>
	</body>
</html>