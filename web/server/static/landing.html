<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf8"/>
		<title>We Snap</title>
		<meta name="description" content=""/>
		<meta name="author" content="Stupeflix"/>
		
		<!-- HTML 5 fix for IE6-8-->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		
		<!-- Stylesheets -->
		<link href="http://fonts.googleapis.com/css?family=Allerta" rel="stylesheet"/>
		<link href="./css/bootstrap.min.css" rel="stylesheet"/>
		<link href="./css/landing.css" rel="stylesheet"/>
		
		<!-- jQuery -->
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>

		<!-- Google Maps -->
		<script src="http://maps.googleapis.com/maps/api/js?sensor=false&libraries=places" type="text/javascript"></script>
	</head>
	
	<body>
		
		<img id="background" src="./img/background.jpg"/>
		
		<div id="container">
			<div id="container-background"></div>
			
			<header>We Snap</header>
			
			<p id="description">
				Create an event and let people add photos to your slideshow <strong>LIVE</strong> from their iPhones!
			</p>
			
			<div id="createevent">
				<input id="eventName" type="text" placeholder="What's your event's name?"><br>
				<input id="eventAddress" type="text" placeholder="Where does it take place?"><br>
				<p class="error" style="display:none"></p>
				<button id="eventSubmit" type="submit" class="btn primary">Create Event</button>
			</div>
		
			<div id="newevent" style="display:none">
				Event created!
				<p>
					View your slideshow at <span id="eventurl"></span>
				</p>
			</div>
			
			<div id="getapp">
				<p>
					Want to join an event?<br/>
					Get <strong>We Snap</strong> for iPhone!
				</p>
				<a href="#" title="Get We Snap on the App Store">
					<img src="./img/appstore.png" alt="iPhone App Store"/>
				</a>
			</div>
		</div>
		
		<script>
			var geocoder;

			function createEvent(eventName, position) {
				remoteService = 'new/' + encodeURIComponent(eventName) + '/' + position.lat() + '/' + position.lng();
				$.get(remoteService, fadeCreateEventButton);
			}

			function fadeCreateEventButton(code) {
				$('#createevent').fadeOut(250, function() {
					pageUrl = window.location.toString();
					url = pageUrl+code;
					$('#eventurl').html('<a href="'+url+'">'+url+'</a>');
					$('#newevent').fadeIn(250);
				});
			}

			$('#createevent button').click(function() {
				var eventName = document.getElementById('eventName').value;
				var eventAddress = document.getElementById('eventAddress').value;
				if (eventName == "" || eventAddress == "") {
					$("#createevent p.error").text("Both fields are required.").slideDown(100);
				} else {
					geocoder.geocode({'address': eventAddress}, function(results, status) {
						if (status == google.maps.GeocoderStatus.OK) {
							createEvent(eventName, results[0].geometry.location);
						} else {
							$('#createevent p.error').text("Couldn't locate the address entered!").slideDown(100);
						}
					});
				}
			});

			$(function() {
				var eventAddress = document.getElementById('eventAddress');
				var autocomplete = new google.maps.places.Autocomplete(eventAddress);
				geocoder = new google.maps.Geocoder();
			});
		</script>
	</body>
</html>